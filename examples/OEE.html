<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=10" />
<!--
To print:

phantomjs.exe ..\examples\rasterize.js file:///C:/ProgramData/COPA-DATA/SQL2012/375239c3-afdc-4772-bd98-bc59809d1cf9/FILES/zenon/custom/additional/report_sunburst.html sunburst.png 800px*600px

C:\tools\phantomjs-2.0.0-windows\bin>phantomjs.exe ..\examples\rasterize-d3.js file:///C:/OCZ/Lavoro/nvd3/examples/OEE.html OEE.pdf A4 1 1cm

-->
<link href="./nv.d3.css" rel="stylesheet" type="text/css">
    <script src="./d3.js" charset="utf-8"></script>
    <script src="./nv.d3.js"></script>
    <script src="./stream_layers.js"></script>

    <style>
        html, body,svg {
            margin: 0px;
            padding: 0px;
            height: 100%;
            width: 100%;
        }
		
		#OEE_1, #OEE_2, #OEE_3, #OEE_4 {
            margin: 0px;
            padding: 0px;
            
			    display: inline !important;
        }
		#PIE, #SUN {
            margin: 0px;
            padding: 0px;
			    display: inline !important;
        }
		
		.divInline{
		margin: 0px;
            padding: 0px;
			    display: inline !important;
		}
    </style>
	
	<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="./bootstrap.min.css">

<!-- Optional theme -->
<link rel="stylesheet" href="./bootstrap-theme.min.css">
</head>
<body>
<!--<div class="divInline">-->
<svg id="OEE_1"></svg>
<!--</div>-->
<!--<div class="divInline">-->
<svg id="OEE_2"></svg>
<!--</div>-->
<!--<div class="divInline">-->
<svg id="OEE_3"></svg>
<!--</div>-->
<!--<div class="divInline">-->
<svg id="OEE_4"></svg>
<!--</div>-->
<div></div>
<!--<div class="divInline">-->
<svg id="PIE"></svg>
<!--</div>-->
<!--<div class="divInline">-->
<svg id="SUN"></svg>
<!--</div>-->
<div></div>

<div id="table1" style="width:350px;"></div>

<!-- <script src="./bootstrap.min.js"></script> -->

<script>

var w = window,
    d = document,
    e = d.documentElement,
    g = d.getElementsByTagName('body')[0],
    x = w.innerWidth || e.clientWidth || g.clientWidth,
    y = w.innerHeight|| e.clientHeight|| g.clientHeight;

    var chart;
	var oee_width=x/4.4;
	var oee_height=x/4.4;
	
	var sun_width=x/2.2;
	var sun_height=x/2.2;
	
	var pie_width=x/2.2;
	var pie_height=x/2.2;
	
	var tab_width=x/2.2+"px";
	
	
    nv.addGraph(function() {
        chart = nv.models.gauge()
		.width(oee_width).height(oee_height)
		.unit("%")
		.redZone({from:0,to:20})
		.yellowZone({from:20,to:50})
		.greenZone({from:50,to:100});

        chart.color(d3.scale.category20c());

        d3.select("#OEE_1")
                .datum([{
            "name": "Disponibilità",
            "value": 90
        }])		
                .call(chart).style({ 'width': oee_width+"px", 'height': oee_height+"px" });
//temp = d3.select("#OEE_1");
//var n=temp.node().parentNode;
//n.style({ 'width': oee_width, 'height': oee_height });
        nv.utils.windowResize(chart.update);

        return chart;
    });
	
	nv.addGraph(function() {
        chart = nv.models.gauge().width(oee_width).height(oee_height).unit("%")
		.redZone({from:0,to:20}).yellowZone({from:20,to:50}).greenZone({from:50,to:100});

        chart.color(d3.scale.category20c());

        d3.select("#OEE_2")
                .datum([{
            "name": "Prestazioni",
            "value": 75
        }])
                .call(chart).style({ 'width': oee_width+"px", 'height': oee_height+"px" });

        nv.utils.windowResize(chart.update);

        return chart;
    });
	
	nv.addGraph(function() {
        chart = nv.models.gauge().width(oee_width).height(oee_height).unit("%")
		.redZone({from:0,to:20}).yellowZone({from:20,to:50}).greenZone({from:50,to:100});

        chart.color(d3.scale.category20c());

        d3.select("#OEE_3")
                .datum([{
            "name": "Qualità",
            "value": 97
        }])
                .call(chart).style({ 'width': oee_width+"px", 'height': oee_height+"px" });

        nv.utils.windowResize(chart.update);

        return chart;
    });
	
	nv.addGraph(function() {
        chart = nv.models.gauge().width(oee_width).height(oee_height).unit("%")
		.redZone({from:0,to:20}).yellowZone({from:20,to:50}).greenZone({from:50,to:100});

        chart.color(d3.scale.category20c());

        d3.select("#OEE_4")
                .datum([{
            "name": "OEE",
            "value": 83
        }])
                .call(chart).style({ 'width': oee_width+"px", 'height': oee_height+"px" });

        nv.utils.windowResize(chart.update);

        return chart;
    });

	nv.addGraph(function() { 
	var height = sun_height; 
     var width = sun_width; 
         chart = nv.models.sunburstChart().mode("size").width(width).height(height).maxdepth(20); 
  
         chart.color(d3.scale.category20c()); 
  
         d3.select("#SUN") 
                 .datum(getData()) 
                 .call(chart).style({ 'width': width+"px", 'height': height+"px" }); 
  
         nv.utils.windowResize(chart.update); 
  
         return chart; 
     }); 

	 

	 	nv.addGraph(function() { 
		var height = pie_height; 
     var width = pie_width; 
         chart = nv.models.pieChart()
.x(function(d) { return d.key }) 
             .y(function(d) { return d.y }) 
             .width(width) 
             .height(height)
			 .showLegend(false).labelsOutside(true).labelSunbeamLayout(false).showLabels(false); 
 
        
  
         d3.select("#PIE") 
                .datum( [ 
         {key: "Setup", y: 5, color: "#5F5"}, 
       {key: "Vistosi", y: 2}, 
         {key: "Scarti Produzione", y: 9}, 
         {key: "Produzione", y: 7}, 
         {key: "Buoni Produzione", y: 4}, 
         {key: "Scarti", y: 3}
     ] 
)
				//.transition().duration(1200) 
				//.attr('width', width) 
				//.attr('height', height) 
				.call(chart).style({ 'width': width+"px", 'height': height+"px" }); 
  
         nv.utils.windowResize(chart.update); 
  
         return chart; 
     }); 
	 
	 
	 nv.addGraph(function() {
  var chart = nv.models.indentedTree()
                .tableClass('table table-striped') //for bootstrap styling
				.width(tab_width)
				
                .columns([
                  {
                    key: 'key',
                    label: 'Metraggi',
                    showCount: false,
                    width: '75%',
                    type: 'text',
                    classes: function(d) { return d.url ? 'clickable name' : 'name' },
                    click: function(d) {
                       if (d.url) window.location.href = d.url;
                    }
                  },
                  {
                    key: 'value',
                    label: 'Lunghezza',
                    width: '25%',
                    type: 'text'
                  }
                ]);


  d3.select('#table1')
      .datum([{values:[
	  {key: "Setup", value: 5}, 
       {key: "Vistosi", value: 2}, 
         {key: "Scarti Produzione", value: 9}, 
         {key: "Produzione", value: 7}, 
         {key: "Buoni Produzione", value: 4}, 
         {key: "Scarti", value: 3}]}]
	  )
    .call(chart).style({"width":tab_width});

  return chart;
});
	
    function getData() {
        return [{ 
"name": "Tempo totale", 
"children": [ 
    {"name": "Planned", 
     "children": [ 
        {"name": "Operating time","children": [],"size": 40 }, 
        {"name": "Down time loss","children": [ 
            {"name": "Tempo 1", "size": 10 }, 
            {"name": "Tempo 2", "size": 10 }, 
            {"name": "Tempo 3", "size": 10 }, 
            {"name": "Tempo 4", "size": 1 }, 
            {"name": "Tempo 5", "size": 10 }, 
            {"name": "Tempo 6", "size": 8 }, 
            {"name": "Tempo 7", "size": 3 }],
			"size":52
        }] 
    }, 
    {"name": "Ferma","children": [],"size":40}, 
    {"name": "Manutenzione ordinaria programmata","children": [],"size":20}] 
}];
    }

</script>
</body>
</html>
